<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zh">
<!--<![endif]-->

<!-- BEGIN HEAD -->
<head>
    <title>分公司非居民月度抄表情况统计表</title>
    <base href="../../">
    <script src="../pages/scripts/basepath.js"></script>
    <script src="pages/scripts/header.js"></script>
    <meta http-equiv="content-type" content="text/html" charset="utf-8"/>

    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/select2/select2.css">
    <link href="assets/admin/pages/css/search.css" rel="stylesheet" type="text/css"/>

    <script src="pages/scripts/header.js"></script>
    <meta http-equiv="content-type" content="text/html" charset="utf-8"/>
    <link rel='stylesheet' href='assets/global/plugins/jquery-watable/watable.css'/>
    <link rel='stylesheet' href='assets/global/plugins/jquery-watable/animate.min.css'/>
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-datepicker/css/datepicker.css"/>
    <link href='assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css' rel='stylesheet'/>

    <link href="assets/global/css/components.css" rel="stylesheet" type="text/css"/>
    <link href="assets/global/css/plugins.css" rel="stylesheet" type="text/css"/>
    <style>
        @media print {
            .noneprint {
                display: none;
            }
        }

        .table-bordered > thead > tr > th, .table-bordered > thead > tr > td {
            border-bottom-width: 1px;
        }

        .areaName {
            padding-left: 20px !important;
            width: 250px;
            align: left !important;
        }
    </style>
    <!-- END THEME STYLES -->
</head>
<!-- END HEAD -->

<body class="page-header-fixed page-quick-sidebar-over-content">

<!-- 标题栏开始 -->
<div class="page-header navbar navbar-fixed-top">
    <script>$.include("pages/partial/menu.shtml");</script>
</div>
<!-- 标题栏结束 -->
<div class="clearfix"></div>
<div class="page-container">
    <!-- 左侧菜单开始 -->
    <div class="page-sidebar-wrapper">
        <script>$.include("pages/partial/sidebar.shtml");</script>
    </div>
    <!-- 左侧菜单结束 -->

    <!-- 主内容开始 -->
    <div class="page-content-wrapper">
        <div class="page-content">
            <!--内容头开始-->
            <script>$.include("common/navigation_bar.shtml");</script>

            <div class="container col-sm-12" style="background-color: #ffffff">
                <div class="container col-sm-12 noneprint">
                    <div class="row">
                        <div class="col-sm-3 form-group">
                            <div class="btn-group input-group input-select2me">
                                <div class="input-group-addon">表具类别:</div>
                                <select id="customerType" class="form-control input-middle select2me"
                                        data-placeholder="表具类别...">
                                    <option value=""></option>
                                    <option value="P">普表</option>
                                    <option value="I">IC卡表</option>
                                </select>
                                <span class="inputclear glyphicon glyphicon-remove-circle hide"></span>
                            </div>
                        </div>
                        <!--<div class="col-sm-3 form-group">-->
                        <!--<div class="btn-group input-group input-select2me">-->
                        <!--<div class="input-group-addon">日期：</div>-->
                        <!--<div class="input-group  date-picker input-daterange"-->
                        <!--data-date="11/2012" data-date-format="yyyy年mm月">-->
                        <!--<input id="find_date" type="text" class="form-control" name="from">-->
                        <!--<span class="inputclear glyphicon glyphicon-remove-circle hidden"></span>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--</div>-->
                        <div class="col-md-3">
                            <div class="form-group ">
                                <button id="find_sign" type="button" class="btn yellow">
                                    查询 <i class="fa fa-search"></i>
                                </button>
                                &nbsp;&nbsp;&nbsp;&nbsp;
                                <button id="btn_print_page" onclick="window.print()" type="button"
                                        class="btn gray disabled">
                                    打印<i class="glyphicon"></i>
                                </button>

                                <button id="btn_down_detail" type="button" class="btn gray disabled export-excel">
                                    导出<i class="glyphicon"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 form-group noneprint" style="margin:10px 0;">
                    <div class="btn-group input-group pull-left col-sm-4">
                        <div class="input-group-addon">抄表月份选择:</div>
                        <div class="input-group input-large date-picker input-daterange" data-date-format="yyyy-mm-dd">
                            <input id="find_start_month_date" type="text" class="form-control" name="from">
                            <span class="inputclear glyphicon glyphicon-remove-circle hidden"></span>
                            <span class="input-group-addon">至</span>
                            <input id="find_end_month_date" type="text" class="form-control" name="to">
                            <span class="inputclear glyphicon glyphicon-remove-circle hidden"></span>
                        </div>
                    </div>
                    <div class="col-sm-8 data-select" id="select_copy_month">
                        <div class="btn-group">
                            <button id="copy_january" class="btn">一月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_february" class="btn">二月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_march" class="btn">三月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_april" class="btn">四月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_may" class="btn">五月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_june" class="btn">六月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_july" class="btn">七月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_august" class="btn">八月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_september" class="btn">九月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_october" class="btn">十月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_november" class="btn">十一月</button>
                        </div>
                        <div class="btn-group">
                            <button id="copy_december" class="btn">十二月</button>
                        </div>
                    </div>

                </div>
                <div class="container-fluid">
                    <div>
                        <table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="title" align="center" title="">非居民月度抄表情况统计表</td>
                            </tr>
                        </table>
                    </div>
                    <br/>
                    <div>
                        <table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="head_r0_c1" rowspan="1" colspan="1" width="85%" align="left">

                                </td>
                                <td id="head_r0_c2" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c3" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c4" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c5" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c6" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c7" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c8" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c9" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c10" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c11" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c12" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c13" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c14" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c15" rowspan="1" colspan="1" width="20%" align="right">单位:立方米／元</td>
                            </tr>
                        </table>
                    </div>
                    <div>
                        <table class="tabPrint table-hover table-condensed " align="center" width="95%" cellSpacing="0"
                               cellPadding="0" border="1"
                               ID="Table2">
                            <thead style="display:table-header-group;font-weight:bold"
                                   mce_style="display:table-header-group;font-weight:bold">
                            <tr align="center">
                                <td id="thead_r1_c1" rowspan="3" colspan="1">分公司</td>
                                <td id="thead_r1_c2" rowspan="3" colspan="1">计划户数</td>
                                <td id="thead_r1_c3" rowspan="3" colspan="1">见表户数</td>
                                <td id="thead_r1_c4" rowspan="3" colspan="1">见表比计划</td>
                                <td id="thead_r1_c5" rowspan="3" colspan="1">上月比例</td>
                                <td id="thead_r1_c6" rowspan="3" colspan="1">与上月相比</td>
                                <td id="thead_r1_c7" rowspan="3" colspan="1">计费完成户数</td>
                                <td id="thead_r1_c8" rowspan="3" colspan="1">销售量</td>
                                <td id="thead_r1_c9" rowspan="3" colspan="1">实收额</td>
                                <td id="thead_r1_c22" rowspan="3" colspan="1">应收额</td>
                                <td id="thead_r1_c23" rowspan="3" colspan="1">回款率</td>
                                <td id="thead_r1_c24" rowspan="3" colspan="1">欠费额</td>
                                <td id="thead_r1_c10" rowspan="3" colspan="1">日均用气量</td>
                                <td id="thead_r1_c11" rowspan="3" colspan="1">零气量户数</td>
                                <td id="thead_r1_c12" rowspan="3" colspan="1">大于1万小于2万</td>
                                <td id="thead_r1_c13" rowspan="3" colspan="1">大于2万小于5万</td>
                                <td id="thead_r1_c14" rowspan="3" colspan="1">大于5万小于10万</td>
                                <td id="thead_r1_c15" rowspan="3" colspan="1">自报户数</td>
                                <td id="thead_r1_c16" rowspan="3" colspan="1">有照片户数</td>
                                <td id="thead_r1_c17" rowspan="3" colspan="1">正常不计费户数</td>
                                <td id="thead_r1_c18" rowspan="3" colspan="1">门锁户数</td>
                                <td id="thead_r1_c19" rowspan="3" colspan="1">遮挡户数</td>
                                <td id="thead_r1_c20" rowspan="3" colspan="1">上传户数</td>
                                <td id="thead_r1_c21" rowspan="3" colspan="1">上传比计划</td>
                            </tr>
                            </thead>
                            <tbody id="tbody">

                            </tbody>
                        </table>
                    </div>
                    <br/>
                    <div>

                        <!--<table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="foot_r0_c1" rowspan="1" colspan="1">负责人：</td>
                                <td id="foot_r0_c2" rowspan="1" colspan="1" width="35%"></td>
                                <td id="foot_r0_c3" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c4" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c5" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c6" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c7" rowspan="1" colspan="1">制表人：</td>
                                <td id="foot_r0_c8" rowspan="1" colspan="1" width="15%"></td>
                                <td id="foot_r0_c9" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c10" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c11" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c12" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c13" rowspan="1" colspan="1" width="20%"></td>
                                <td id="foot_r0_c14" rowspan="1" colspan="1">填报日期：</td>
                                <td id="foot_r0_c15" rowspan="1" colspan="1"></td>
                            </tr>
                        </table>-->
                    </div>
                    <br/><br/></div>
            </div>
        </div>
    </div>
</div>
<!-- 主内容结束 -->
</div>
<script type="text/javascript">$.include("pages/partial/xwatable-form.shtml")</script>

<!-- 底边栏开始 -->
<script>$.include("pages/partial/foot.shtml");</script>
<!-- 底边栏结束 -->
</body>
<script>
    $.include("pages/partial/scripts.shtml");

</script>
<!--跳到原稿-->
<script src="../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../assets/global/plugins/jquery-watable/jquery.watable.js"></script>
<script type="text/javascript" src="../pages/scripts/rqlbuilder.js"></script>
<script type="text/javascript" src="../pages/scripts/xwatable.js"></script>
<script type="text/javascript" src="../pages/scripts/refhelper.js"></script>

<!--datapicker start-->
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript"
        src="../assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/clockface/js/clockface.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
<script type="text/javascript"
        src="../assets/global/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript"
        src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../assets/admin/pages/scripts/components-pickers.js"></script>

<script type="text/javascript" src="../assets/global/plugins/select2/select2.js"></script>


<script src="/statement/js/libs/js-xlsx/xlsx.core.min.js" type="text/javascript"></script>
<script src="/statement/js/libs/html2canvas/html2canvas.min.js" type="text/javascript"></script>
<script src="/statement/js/tableExport.js" type="text/javascript"></script>
<script src="mods/ctm.js"></script>
<script src="mods/timeslot.js"></script>
<script src="mods/sys.js"></script>
<script src="mods/mrd.js"></script>

<!-- END PAGE LEVEL SCRIPTS -->
<script type="text/javascript">
    ComponentsPickers.init();
    var enumselectcopymonth = {
        "copy_january": {"12-26": "01-25"}, "copy_february": {"01-26": "02-25"},
        "copy_march": {"02-26": "03-25"}, "copy_april": {"03-26": "04-25"},
        "copy_may": {"04-26": "05-25"}, "copy_june": {"05-26": "06-25"},
        "copy_july": {"06-26": "07-25"}, "copy_august": {"07-26": "08-25"},
        "copy_september": {"08-26": "09-25"}, "copy_october": {"09-26": "10-25"},
        "copy_november": {"10-26": "11-25"}, "copy_december": {"11-26": "12-25"}
    };
    $(".export-excel").attr("data-table", ".tabPrint");
    //    $(".export-excel").attr("data-filename","");
    $(".export-excel").on("click", function (e) {
        e.preventDefault();
        var exportTable = $(this).data("table");
        var filename = $("#title").html();//$(this).data("filename");
        var ignoreColumn = "";//$(this).data("ignorecolumn");
        $(exportTable).tableExport({
            fileName: filename,
            type: 'excel',
            escape: 'false',
            excelstyles: ['border-bottom', 'border-top', 'border-left', 'border-right'],
            ignoreColumn: '[' + ignoreColumn + ']'
        });
    });
//    var userHelper = RefHelper.create({
//        ref_url: 'gassysuser',
//        ref_col: "userId",
//        ref_display: "employeeName",
//    });
    var areaHelper = RefHelper.create({
        ref_url: 'gasbizarea',
        ref_col: "areaId",
        ref_display: "areaName",
    });
//    var loginarea = [];
//    var areaId = JSON.parse(localStorage.getItem("user_info")).area_id
//    GasModSys.areaList({
//        "areaId": areaId,
//        "cb": function (data) {
//            console.log(data)
//            $.each(data, function (key, val) {
//                loginarea.push(val.areaId);
//                $('#find_area').append('<option value="' + val.areaId + '" name="' + val.areaId + '">' + val.areaName + '</option>');
//            })
//        }
//    });

    $("#find_sign").click(function () {
        var customerType = $('#customerType').val();
        if (customerType == "") {
            bootbox.alert("请您选择要查询的客户类型！");
            return;
        }
        if ($('#find_start_month_date').val() == "" || $('#find_end_month_date').val() == "") {
            bootbox.alert("请您选择要查询的月份！");
            return;
        }
//        var dialog = bootbox.dialog({
//            message: '<p class="text-center" style="font-size:2.5rem">数据查询中，请稍后...</p>',
//            closeButton: false
//        });
//        dialog.init(function () {
        var start = $('#find_start_month_date').val();
        var end = $('#find_end_month_date').val();
        var datayearmonthday = GasModMrd.enumStatisticsMonth;
        var month=start.substring(5,7);
        if(month<10){
            month=start.substring(6,7)
        }
        var year=start.substring(0, 4);
        if(month==1){
            year=year-1;
        }
        var reportTime = end.substring(0, 4) + "年" + end.substring(5, 7) + "月"
        $("#title").html(reportTime + "&nbsp;&nbsp;分公司非居民月度抄表情况统计表");
        var gs = new Array();
        var tbody = "";
        var $tbody = $("#tbody");
        var bd = {
            "cols": "area_id",
            "froms": "gas_biz_area",
            "wheres": "status=1 and area_id<>1 order by pos_code",
            "page": false
        };
        $.ajax({
            type: 'get',
            url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd),
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (data) {
                console.log(data);
                for (var i = 0; i < data.rows.length; i++) {
                    if (data.rows[i].areaId!=null) {
                        gs.push(data.rows[i].areaId);
                        tbody = tbody + '<tr align="center" data-userid="'+(4 + 1 + i)+'">' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c1" rowspan="1" colspan="1">' + areaHelper.getDisplay(gs[i]) + '</td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c2" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c3" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c4" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c5" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c6" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c7" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c8" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c9" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c22" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c23" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c24" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c10" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c11" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c12" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c13" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c14" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c15" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c16" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c17" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c18" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c19" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c20" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r' + (4 + 1 + i) + '_c21" rowspan="1" colspan="1"></td>' +

                                '</tr>';
                        $("#tbody").html(tbody);
                    }
                }
                $("#tbody").append('<tr align="center">' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c1" rowspan="1" colspan="1">总和</td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c2" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c3" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c4" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c5" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c6" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c7" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c8" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c9" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c22" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c23" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c24" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c10" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c11" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c12" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c13" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c14" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c15" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c16" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c17" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c18" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c19" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c20" rowspan="1" colspan="1"></td>' +
                        '<td id="tbody_r' + (4 + 1 + data.rows.length) + '_c21" rowspan="1" colspan="1"></td>' +
                        '</tr>');

            }
        });
        var plan;
        var sumPlan = 0;
        var lastplan;
        var sumLastPlan=0;
        var lastseemeter;
        var sumLastSeeMeter=0;
        var lastPlanProportion;
        var sumLastPlanProportion;
        var already;
        var sumAlready = 0;
        var bllFinish;
        var sumBllFinish = 0;
        var sell;
        var sumSell = 0;
        var sellsse;
        var sumSellsse=0;
        var owe;
        var sumOwe=0;
        var sellsseProportion;
        var sumSellsseProportion;
        var realReceive;
        var sumRealReceive = 0;
        var dailyMeasure;
        var planProportion;
        var planProportion1;
        var sumPlanProportion;
        var sumPlanProportion1;
        var zerocustomer;
        var sumZeroCustomer = 0;
        var betterone;
        var sumBetterone = 0;
        var bettertwo;
        var sumBettertwo = 0;
        var betterFive;
        var sumBetterFive = 0;
        var normalNoBilling;
        var sumNormalNoBilling = 0;
        var oneself;
        var sumOneself = 0;
        var seeMeter;
        var sumSeeMeter=0;
        var stock;
        var sumStock = 0;
        var keepOut;
        var sumKeepOut = 0;
        var havePhoto;
        var sumHavePhoto = 0;
        for (var i = 0; i < gs.length; i++) {
            var bd = {
                "cols": "sum(plan)plan,sum(already)already,sum(lastplan)lastplan,sum(lastseemeter)lastseemeter,sum(zerocustomer)zerocustomer,sum(betterone)betterone,sum(bettertwo)bettertwo,sum(bettertwo)betterfive,sum(oneself)oneself,sum(copy_state)normalnobilling,sum(seemeter)seemeter,sum(stock)stock,sum(keepout)keepout,sum(havephoto)havephoto",
                "froms": "(select ctm_archive_id,area_id," +
                "(case when  operate='P' and copy_state<>'9' and (plan_copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) and nvl(copy_state,'0')<>'9' then 1 else 0 end)plan," +
                "(case when  operate='P' and copy_state<>'9' and (plan_copy_time between to_date('" + year + "-" + datayearmonthday[(month)][0] + "','yyyy-mm-dd hh24:mi:ss') and to_date('" + year + "-" + datayearmonthday[(month)][1] + "','yyyy-mm-dd hh24:mi:ss')) and nvl(copy_state,'0')<>'9' then 1 else 0 end)lastplan," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and data_source='01' and (copy_time between to_date('" + year + "-" + datayearmonthday[(month)][0] + "','yyyy-mm-dd hh24:mi:ss') and to_date('" + year + "-" + datayearmonthday[(month)][1] + "','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)lastseemeter," +
                "(case when  is_mrd='1' and copy_state!='9' and operate!='S' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)already," +
//                "(case when  is_bll='1' and is_mrd='1' and copy_state='6' and operate<>'S' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)bllfinish," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and meter_reading=last_meter_reading and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)zerocustomer," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and nvl(charge_meter_reading,'0')>10000 and nvl(charge_meter_reading,'0')<=20000 and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)betterone," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and nvl(charge_meter_reading,'0')>20000 and nvl(charge_meter_reading,'0')<=50000 and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)bettertwo," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and nvl(charge_meter_reading,'0')>50000 and nvl(charge_meter_reading,'0')<=100000 and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)betterfive," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and data_source='02' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)oneself," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and copy_state='A' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss')) then 1 else 0 end)copy_state," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and data_source='01' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)seemeter," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and data_source='04' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)stock," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and data_source='06' and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)keepout," +
                "(case when  operate<>'S' and is_mrd='1' and copy_state!='9' and (meter_photo is not null or revise_photo is not null or feedback_photo is not null) and (copy_time between to_date('" + start + " 00:00:00','yyyy-mm-dd hh24:mi:ss') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))  then 1 else 0 end)havephoto " +
                "from gas_mrd_meter_reading)t left join gas_ctm_archive a on t.ctm_archive_id=a.ctm_archive_id left join gas_ctm_meter m on a.ctm_archive_id=m.ctm_archive_id",
                "wheres": "customer_type='" + customerType + "' and a.customer_kind='9' and meter_user_state in('01','04') and t.area_id='" + gs[i] + "'",
                "page": false
            };
            $.ajax({
                type: 'get',
                url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd),
                dataType: 'json',
                contentType: "application/json; charset=utf-8",
                para: i,
                success: function (data) {
                    plan = (data.rows[0].plan ? data.rows[0].plan : "0");
                    sumPlan = parseInt(sumPlan) + parseInt(plan);
                    lastplan=(data.rows[0].lastplan ? data.rows[0].lastplan : "0");
                    sumLastPlan=parseInt(sumLastPlan) + parseInt(lastplan);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c2').html(plan);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c2').html(sumPlan);

                    seeMeter=(data.rows[0].seemeter ? data.rows[0].seemeter : "0");
                    sumSeeMeter = parseInt(sumSeeMeter) + parseInt(seeMeter);
                    lastseemeter=(data.rows[0].lastseemeter ? data.rows[0].lastseemeter : "0");
                    sumLastSeeMeter=parseInt(sumLastSeeMeter) + parseInt(lastseemeter);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c3').html(seeMeter);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c3').html(sumSeeMeter);

//                    bllFinish = (data.rows[0].bllfinish ? data.rows[0].bllfinish : "0");
//                    sumBllFinish = parseInt(sumBllFinish) + parseInt(bllFinish);
//                    $('#tbody_r' + (4 + 1 + this.para) + '_c7').html(bllFinish);
//                    $('#tbody_r' + (4 + 1 + gs.length) + '_c7').html(sumBllFinish);

                    zerocustomer = (data.rows[0].zerocustomer ? data.rows[0].zerocustomer : "0");
                    sumZeroCustomer = parseInt(sumZeroCustomer) + parseInt(zerocustomer);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c11').html(zerocustomer);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c11').html(sumZeroCustomer);

                    betterone = (data.rows[0].betterone ? data.rows[0].betterone : "0");
                    sumBetterone = parseInt(sumBetterone) + parseInt(betterone);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c12').html(betterone);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c12').html(sumBetterone);

                    bettertwo = (data.rows[0].bettertwo ? data.rows[0].bettertwo : "0");
                    sumBettertwo = parseInt(sumBetterone) + parseInt(bettertwo);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c13').html(bettertwo);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c13').html(sumBettertwo);

                    betterFive = (data.rows[0].betterfive ? data.rows[0].betterfive : "0");
                    sumBetterFive = parseInt(sumBetterFive) + parseInt(betterFive);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c14').html(betterFive);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c14').html(sumBetterFive);


                    oneself = (data.rows[0].oneself ? data.rows[0].oneself : "0");
                    sumOneself = parseInt(sumOneself) + parseInt(oneself);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c15').html(oneself);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c15').html(sumOneself);

                    havePhoto = (data.rows[0].havephoto ? data.rows[0].havephoto : "0");
                    sumHavePhoto = parseInt(sumHavePhoto) + parseInt(havePhoto);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c16').html(havePhoto);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c16').html(sumHavePhoto);

                    normalNoBilling = (data.rows[0].normalnobilling ? data.rows[0].normalnobilling : "0");
                    sumNormalNoBilling = parseInt(sumNormalNoBilling) + parseInt(normalNoBilling);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c17').html(normalNoBilling);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c17').html(sumNormalNoBilling);

                    stock = (data.rows[0].stock ? data.rows[0].stock : "0");
                    sumStock = parseInt(sumStock) + parseInt(stock);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c18').html(stock);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c18').html(sumStock);

                    keepOut = (data.rows[0].keepout ? data.rows[0].keepout : "0");
                    sumKeepOut = parseInt(sumKeepOut) + parseInt(keepOut);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c19').html(keepOut);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c19').html(sumKeepOut);


                    already = (data.rows[0].already ? data.rows[0].already : "0");
                    sumAlready = parseInt(sumAlready) + parseInt(already);
                    $('#tbody_r' + (4 + 1 + this.para) + '_c20').html(already);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c20').html(sumAlready);
                    //见表比计划
                    if (parseInt(seeMeter) == 0 || parseInt(plan) == 0) {
                        planProportion = 0;
                    } else {
                        planProportion = Math.round(seeMeter / plan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + this.para) + '_c4').html(planProportion+ "%");
                    //上个月见表比计划
                    if (parseInt(lastseemeter) == 0 || parseInt(lastplan) == 0) {
                        lastPlanProportion = 0;
                    } else {
                        lastPlanProportion = Math.round(lastseemeter / lastplan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + this.para) + '_c5').html(lastPlanProportion+ "%");
                    //实抄比计划
                    if (parseInt(already) == 0 || parseInt(plan) == 0) {
                        planProportion1 = 0;
                    } else {
                        planProportion1 = Math.round(already / plan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + this.para) + '_c21').html(planProportion1+ "%");
                    //与上月相比
                    $('#tbody_r' + (4 + 1 + this.para) + '_c6').html((planProportion-lastPlanProportion).toFixed(2)+"%");
                    //总和见表比计划
                    if (parseInt(sumPlan) == 0 || parseInt(sumSeeMeter) == 0) {
                        sumPlanProportion = 0;
                    } else {
                        sumPlanProportion = Math.round(sumSeeMeter / sumPlan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c4').html(sumPlanProportion+ "%");
                    //总和上个月见表比计划
                    if (parseInt(sumLastPlan) == 0 || parseInt(sumLastSeeMeter) == 0) {
                        sumLastPlanProportion = 0;
                    } else {
                        sumLastPlanProportion = Math.round(sumLastSeeMeter / sumLastPlan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c5').html(sumLastPlanProportion+ "%");
                    //总和实抄比计划
                    if (parseInt(sumPlan) == 0 || parseInt(sumAlready) == 0) {
                        sumPlanProportion1 = 0;
                    } else {
                        sumPlanProportion1 = Math.round(sumAlready / sumPlan * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c21').html(sumPlanProportion1+ "%");

                    //总和与上月相比
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c6').html((sumPlanProportion-sumLastPlanProportion).toFixed(2)+"%");
                }
            });
            var bd1 = {
                "cols": "sum(gas)gas,sum(sse)sse",
                "froms": "gas_report_ysl_new",
                "wheres": "customer_type='" + customerType + "' and customer_kind='9' and area_id='" + gs[i] + "'" +
                "and (trade_date between to_date('" + start + "','yyyy-mm-dd') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))",
                "page": false
            };
            var bd2 = {
                "cols": "sum(money)money",
                "froms": "gas_report_sse_new",
                "wheres": "customer_type='"+customerType+"' and customer_kind='9' and area_id='" + gs[i] + "'" +
                "and (trade_date between to_date('"+start+"','yyyy-mm-dd') and to_date('"+end+" 23:59:59','yyyy-mm-dd hh24:mi:ss'))",
                "page": false
            };
            var bd3 = {
                "cols": "count(customer_code) bllfinish",
                "froms": "gas_ctm_archive a left join gas_mrd_meter_reading r on a.ctm_archive_id=r.ctm_archive_id",
                "wheres": "is_bll='1' and is_mrd='1' and copy_state='6' and operate<>'S' and a.customer_type='" + customerType + "' and a.customer_kind='9' and r.area_id='" + gs[i] + "'" +
                "and (copy_time between to_date('" + start + "','yyyy-mm-dd') and to_date('" + end + " 23:59:59','yyyy-mm-dd hh24:mi:ss'))",
                "page": false
            };
            $.when(
                    $.ajax({
                        type: 'get',
                        url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd1),
                        dataType: 'json',
                        para: i,
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            sell = (data.rows[0].gas ? data.rows[0].gas : "0");
                            $('#tbody_r' + (4 + 1 + this.para) + '_c8').html(sell);
                            sumSell = parseInt(sumSell) + parseInt(sell);
                            $('#tbody_r' + (4 + 1 + gs.length) + '_c8').html(sumSell);

                            sellsse = (data.rows[0].sse ? data.rows[0].sse : "0");
                            $('#tbody_r' + (4 + 1 + this.para) + '_c22').html(sellsse);
                            sumSellsse=parseInt(sumSellsse) + parseInt(sellsse);
                            $('#tbody_r' + (4 + 1 + gs.length) + '_c22').html(sumSellsse);
                        }
                    }),
                    $.ajax({
                        type: 'get',
                        url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd3),
                        dataType: 'json',
                        para: i,
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            bllFinish = (data.rows[0].bllfinish ? data.rows[0].bllfinish : "0");
                            sumBllFinish = parseInt(sumBllFinish) + parseInt(bllFinish);
                            $('#tbody_r' + (4 + 1 + this.para) + '_c7').html(bllFinish);
                            $('#tbody_r' + (4 + 1 + gs.length) + '_c7').html(sumBllFinish);
                        }
                    }),
                    $.ajax({
                        type: 'get',
                        url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd2),
                        dataType: 'json',
                        para: i,
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            realReceive = (data.rows[0].money ? data.rows[0].money : "0");
                            $('#tbody_r' + (4 + 1 + this.para) + '_c9').html(realReceive);
                            sumRealReceive = parseFloat(sumRealReceive).toFixed(2) * 1 + parseFloat(realReceive).toFixed(2) * 1;
                            $('#tbody_r' + (4 + 1 + gs.length) + '_c9').html(sumRealReceive.toFixed(2));
                        }
                    })
            ).then(function () {
                $("#tbody").find("tr").each(function(){
                    var serviceperId=$(this).data("userid");
                    console.log(111111,serviceperId);
                    var c7=$(this).find("#tbody_r"+serviceperId+"_c7").html();
                    var c8=$(this).find("#tbody_r"+serviceperId+"_c8").html();
                    var sum7=$('#tbody_r' + (4 + 1 + gs.length) + '_c7').html();
                    var sum8=$('#tbody_r' + (4 + 1 + gs.length) + '_c8').html();
                    if (parseInt(c8) == 0 || parseInt(c7) == 0) {
                        dailyMeasure = 0;
                    } else {
                        var daily = c7 * 180;
                        dailyMeasure = (c8 / daily).toFixed(2) * 1;
                    }
                    var sumDaily=sum7*180;
                    var sumDailyMeasure=(sum8 / sumDaily).toFixed(2) * 1;
                    $(this).find("#tbody_r"+serviceperId+"_c10").html(dailyMeasure);
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c10').html(sumDailyMeasure);


                    //回款率
                    var c9=$(this).find("#tbody_r"+serviceperId+"_c9").html();
                    var c22=$(this).find("#tbody_r"+serviceperId+"_c22").html();
                    var sum9=$('#tbody_r' + (4 + 1 + gs.length) + '_c9').html();
                    var sum22=$('#tbody_r' + (4 + 1 + gs.length) + '_c22').html();

                    if (parseInt(c9) == 0 || parseInt(c22) == 0) {
                        sellsseProportion = 0;
                    } else {
                        sellsseProportion = Math.round(c9 / c22 * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + serviceperId + '_c23').html(sellsseProportion+ "%");

                    if (parseInt(sum9) == 0 || parseInt(sum22) == 0) {
                        sumSellsseProportion = 0;
                    } else {
                        sumSellsseProportion = Math.round(sum9 / sum22 * 10000) / 100.00 ;
                    }
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c23').html(sumSellsseProportion+ "%");
                })
            })

            var bd4 = {
                "cols": "sum(balance)balance",
                "froms": "gas_report_ljye_new",
                "wheres": "customer_type='" + customerType + "' and customer_kind='9' and balance < 0 and area_id='" + gs[i] + "'" +
                "and report_year='"+end.substring(0, 4)+"' and report_month='"+end.substring(5, 7)+"'",
                "page": false
            };
            $.ajax({
                type: 'get',
                url: '/hzqs/dbc/pbsel.do?bd=' + JSON.stringify(bd4),
                dataType: 'json',
                para: i,
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    owe = (data.rows[0].balance ? data.rows[0].balance : "0");
                    $('#tbody_r' + (4 + 1 + this.para) + '_c24').html(owe);
                    sumOwe = parseFloat(sumOwe).toFixed(2) * 1 + parseFloat(owe).toFixed(2) * 1;
                    $('#tbody_r' + (4 + 1 + gs.length) + '_c24').html(sumOwe.toFixed(2));
                }
            })

//            if (parseInt(sumPlan) == 0 || parseInt(sumAlready) == 0) {
//                sumPlanProportion = 0;
//            } else {
//                sumPlanProportion = Math.round(sumAlready / sumPlan * 10000) / 100.00 + "%";
//            }
//            tbody= '<tr align="center">' +
//                    '<td  rowspan="1" colspan="1">总和</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumPlan + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumAlready + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumPlanProportion + '</td>' +
//                    '<td  rowspan="1" colspan="1"></td>' +
//                    '<td  rowspan="1" colspan="1"></td>' +
//                    '<td  rowspan="1" colspan="1">' + sumBllFinish + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumSell + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumRealReceive + '</td>' +
//                    '<td  rowspan="1" colspan="1"></td>' +
//                    '<td  rowspan="1" colspan="1">' + sumZeroCustomer + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumLittleFive + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumBetterFive + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumOneself + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumNormalNoBilling + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumStock + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumKeepOut + '</td>' +
//                    '<td  rowspan="1" colspan="1">' + sumHavePhoto + '</td>' +
//                    '</tr>';
//            $(tbody).appendTo('#tbody');
        }


        var userInfo = JSON.parse(localStorage.getItem("user_info"));
//        if (userInfo.employee_name) {
//            $("#foot_r0_c8").html(userInfo.employee_name);
//        } else {
//            $("#foot_r0_c8").html("管理员");
//        }
//        $("#foot_r0_c15").html(date_format(new Date(), "yyyy-MM-dd"));
        $("#head_r0_c1").html("制表单位:" + areaHelper.getDisplay('1'));
        $("#btn_down_detail").removeClass("disabled");
        $("#btn_down_detail").removeClass("gray");
        $("#btn_down_detail").addClass("green");

        $("#btn_print_page").removeClass("disabled");
        $("#btn_print_page").removeClass("gray");
        $("#btn_print_page").addClass("green");
//        });
    });
    $('#select_copy_month').on('click', '.btn', function (e) {
        var mydate = new Date();
        var fullyear = mydate.getFullYear();
        var copyids2 = this.id;
        var copyids = $(this)[0].id;
        console.log(copyids);
        var copydatetofrom = enumselectcopymonth[copyids];

        for (var x in copydatetofrom) {
            // console.log(x,a[x]);
            if (x == '12-26') {
                var yyear = (parseInt(fullyear) - 1);
                $('#find_start_month_date').val(yyear + "-" + x);

            } else {
                $('#find_start_month_date').val(fullyear + "-" + x);
            }
            $('#find_end_month_date').val(fullyear + "-" + copydatetofrom[x]);
        }

        console.log(copydatetofrom);
    })
    function date_format(date, fmt) {
        var dataJson = {
            "M+": date.getMonth() + 1, //月份
            "d+": date.getDate(), //日
            "h+": date.getHours(), //小时
            "m+": date.getMinutes(), //分
            "s+": date.getSeconds(), //秒
            "q+": Math.floor((date.getMonth() + 3) / 3), //季度
            "S": date.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in dataJson)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (dataJson[k]) : (("00" + dataJson[k]).substr(("" + dataJson[k]).length)));
        return fmt;
    }

</script>
</html>